(()=>{"use strict";document.addEventListener("DOMContentLoaded",(()=>{if(!localStorage.getItem("currentUser")||!JSON.parse(localStorage.getItem("currentUser")))return alert("Silakan login untuk mengakses Rekomendasi."),void(window.location.href="login.html");const a=JSON.parse(localStorage.getItem("lastPrediction")),n=document.getElementById("recommendations");a?function(a,n){const i="string"==typeof a.prediction?parseInt(a.prediction):a.prediction,e=function(a){switch(a){case 0:return{level:"Tidak Stres",emoji:"😊",class:"stress-low"};case 1:return{level:"Stres Minimal",emoji:"😌",class:"stress-low"};case 2:return{level:"Agak Stres",emoji:"😐",class:"stress-medium"};case 3:return{level:"Cukup Stres",emoji:"😟",class:"stress-high"};case 4:return{level:"Sangat Stres",emoji:"😰",class:"stress-high"};default:return{level:"Status Tidak Diketahui",emoji:"❓",class:"stress-medium"}}}(i),t=function(a){switch(a){case 0:case 1:return[{category:"wellness",icon:"🧘‍♀️",title:"Pertahankan Keseimbangan",description:"Terus lakukan rutinitas sehat yang sudah Anda jalani. Lakukan olahraga ringan 30 menit setiap hari.",action:"Buat jadwal olahraga rutin"},{category:"sleep",icon:"😴",title:"Jaga Pola Tidur",description:"Pertahankan jadwal tidur yang konsisten 7-8 jam per malam untuk menjaga kesehatan mental.",action:"Atur alarm tidur dan bangun"},{category:"hobby",icon:"🎨",title:"Luangkan Waktu untuk Hobi",description:"Nikmati aktivitas yang Anda sukai untuk menjaga suasana hati tetap positif.",action:"Jadwalkan waktu me-time"},{category:"gratitude",icon:"🙏",title:"Praktikkan Rasa Syukur",description:"Tulis 3 hal positif setiap hari di jurnal untuk meningkatkan kebahagiaan.",action:"Mulai jurnal syukur"}];case 2:return[{category:"breathing",icon:"🫁",title:"Latihan Pernapasan",description:"Lakukan teknik pernapasan dalam 4-7-8 selama 5-10 menit untuk menenangkan pikiran.",action:"Praktek 2x sehari"},{category:"meditation",icon:"🧘",title:"Meditasi Terpandu",description:"Cobalah meditasi mindfulness 10 menit setiap hari untuk mengurangi ketegangan.",action:"Download aplikasi meditasi"},{category:"organization",icon:"📅",title:"Atur Jadwal Harian",description:"Buat struktur harian yang jelas untuk mengurangi perasaan kewalahan.",action:"Buat to-do list harian"},{category:"social",icon:"👥",title:"Berbagi dengan Orang Terdekat",description:"Ceritakan perasaan Anda kepada teman atau keluarga untuk mendapatkan dukungan.",action:"Hubungi seseorang hari ini"}];case 3:case 4:return[{category:"meditation",icon:"🧘‍♂️",title:"Meditasi Intensif",description:"Lakukan meditasi mindfulness 15-20 menit, 2 kali sehari untuk mengurangi stres berat.",action:"Ikuti kelas meditasi"},{category:"nature",icon:"🌿",title:"Terapi Alam",description:"Habiskan waktu di alam terbuka minimal 30 menit setiap hari untuk menyegarkan pikiran.",action:"Jadwalkan jalan di taman"},{category:"professional",icon:"👨‍⚕️",title:"Konsultasi Profesional",description:"Pertimbangkan untuk berkonsultasi dengan psikolog atau konselor untuk bantuan lebih lanjut.",action:"Cari profesional terdekat"},{category:"lifestyle",icon:"🥗",title:"Perbaiki Gaya Hidup",description:"Kurangi kafein, gula, dan alkohol. Tingkatkan konsumsi makanan bergizi untuk stabilitas mood.",action:"Buat meal plan sehat"}];default:return[{category:"assessment",icon:"📊",title:"Lakukan Penilaian Ulang",description:"Hasil prediksi tidak valid. Lakukan Daily Check-In kembali untuk mendapatkan rekomendasi yang tepat.",action:"Kembali ke Daily Check-In"}]}}(i);var s;n.innerHTML=`\n    <div class="row justify-content-center">\n      <div class="col-md-10 col-lg-8">\n        <div class="recommendation-header ${e.class}">\n          <div class="stress-indicator">\n            <span class="stress-emoji">${e.emoji}</span>\n            <div class="stress-info">\n              <h3>${e.level}</h3>\n              <p class="stress-date">Berdasarkan hasil prediksi ${s=a.date,new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}</p>\n            </div>\n          </div>\n        </div>\n\n        <div class="recommendations-content">\n          <h4>Rekomendasi untuk Anda</h4>\n          <div class="recommendations-grid">\n            ${t.map(((a,n)=>`\n              <div class="recommendation-card" data-category="${a.category}">\n                <div class="recommendation-icon ${a.category}">\n                  ${a.icon}\n                </div>\n                <div class="recommendation-content">\n                  <h5>${a.title}</h5>\n                  <p>${a.description}</p>\n                  ${a.action?`<div class="recommendation-action">${a.action}</div>`:""}\n                </div>\n              </div>\n            `)).join("")}\n          </div>\n\n          <div class="additional-tips">\n            <h5>Tips Tambahan</h5>\n            <div class="tips-list">\n              ${function(a){return["Batasi penggunaan media sosial dan berita negatif","Lakukan aktivitas fisik ringan seperti stretching setiap 2 jam","Minum air putih minimal 8 gelas per hari","Hindari multitasking berlebihan",...{0:["Bagikan kebahagiaan Anda dengan orang lain","Coba tantangan baru yang positif"],1:["Pertahankan rutinitas yang sudah baik","Rayakan pencapaian kecil"],2:["Buat prioritas tugas harian","Ambil break 15 menit setiap 2 jam kerja"],3:["Praktikkan teknik grounding 5-4-3-2-1","Batasi konsumsi kafein setelah jam 2 siang"],4:["Hubungi hotline kesehatan mental jika diperlukan","Pertimbangkan cuti singkat jika memungkinkan"]}[a]||[]]}(i).map((a=>`\n                <div class="tip-item">\n                  <span class="tip-bullet">💡</span>\n                  <span>${a}</span>\n                </div>\n              `)).join("")}\n            </div>\n          </div>\n\n          <div class="recommendation-footer">\n            <p class="disclaimer">\n              <strong>Catatan:</strong> Rekomendasi ini bersifat umum dan tidak menggantikan konsultasi dengan profesional kesehatan mental. \n              Jika Anda merasa membutuhkan bantuan lebih lanjut, jangan ragu untuk mencari bantuan ahli.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  `,setTimeout((()=>{n.querySelectorAll(".recommendation-card").forEach(((a,n)=>{setTimeout((()=>{a.style.opacity="1",a.style.transform="translateY(0)"}),100*n)}))}),300)}(a,n):n.innerHTML='\n    <div class="row justify-content-center">\n      <div class="col-md-8 col-lg-6">\n        <div class="no-recommendation">\n          <div class="no-recommendation-emoji">🤔</div>\n          <h4>Belum Ada Rekomendasi</h4>\n          <p>Lakukan Daily Check-In terlebih dahulu untuk mendapatkan rekomendasi yang sesuai dengan kondisi Anda.</p>\n          <a href="checkin.html" class="cta-button">Mulai Daily Check-In</a>\n        </div>\n      </div>\n    </div>\n  '}))})();